<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<title> brb kms </title>
	<link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">

</head>
<body>
	<style>
	html{
		height:100%;
	}
	body {
    min-height: 100%;
		/*background-color:#000;*/
		overflow:hidden;
		margin:0px;
		font-family: 'Indie Flower', cursive;
	}
	.same{
		width:100%;
		height:100%;
		padding:0px;
		margin:0px;
	}

	img {
    display: inline;
		width:100%;
		height:100%;
	}

	td{
		width:200px;
		height:200px;
		margin:0px;
		padding:0px;
		spacing:0px;
	}

	table{
		width:100%;
		height:100%;
		border:none;
		border-spacing:0px;
	}

	.dropbtn {
		position: fixed;
    bottom: 0;
    right: 0;
		background-color:#ddd;
		background-image: url('img/menu.png');
		background-size: cover;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		padding:30px;
		border-radius:20px;
		border-style: solid;
		position:absolute;
		bottom:10;
		right:10;
		height:50px;
		width:50px;
	}
	.dropbtn:focus {
    outline:none;
	}
	.dropbtn:hover{
		background-color:#ccc;
	}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: rgba(255,255,255,0.6);
    min-width: 300px;
		right:30px;
		bottom:75px;
		font-size:30px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a#heart{
	background-color:rgba(255,255,0,0.7);
}
.dropdown-content a#heart:hover{
	background-color:rgba(200,200,0,0.7);
}
.dropdown-content a#roll{
	background-color:rgba(0,255,255,0.7);
}
.dropdown-content a#roll:hover{
	background-color:rgba(0,200,200,0.7);
}
.dropdown-content a#beaut{
	background-color:rgba(255,0,255,0.7);
}
.dropdown-content a#beaut:hover{
	background-color:rgba(200,0,200,0.7);
}
.dropdown-content a#silence{
	background-color:rgba(0,0,255,0.7);
}
.dropdown-content a#silence:hover{
	background-color:rgba(0,0,200,0.7);
}
.dropdown-content a#life{
	background-color:rgba(255,0,0,0.7);
}
.dropdown-content a#life:hover{
	background-color:rgba(200,0,0,0.7);
}

.show {display:block;}

#overlay{
	/*opacity:0.0;*/
	background-color:rgba(0, 0, 0, 0.0);
}

	</style>

	<div class="dropdown">
	  <button onclick="myFunction()" class="dropbtn"></button>
	  <div id="myDropdown" class="dropdown-content">
	    <a href="#" onclick="song('heart')" id="heart">me heart will go on</a>
	    <a href="#" onclick="song('nevergonna')" id="roll">best song na</a>
	    <a href="#" onclick="song('beautiful')" id="beaut">im beautiful</a>
			<a href="#" onclick="song('silence')" id="silence">moment of silence</a>
			<a href="#" onclick="song('life')" id="life">bring me to life</a>
	  </div>
	</div>

	<table border="0" cellspacing="0" cellpadding="0" id="cont">

	</table>

	<!-- <div id="overlay" style="width:100%;margin:0px; height:100%"> -->
	<!-- </div> -->
</body>

<script>
var width = 200;
var height = 200;
var screenWidth = screen.width
var screenHeight = screen.height
var char = screenWidth/width
var row = screenHeight/height
var table = document.getElementById("cont");
var same = Math.ceil(row)
var same2 = Math.ceil(char)
var gridStatusArray = new Array(40+1).join('0').split('').map(parseFloat)


init()
var audio;

function init(){
	for (var x=0; x<=same; x++){
		var row = table.insertRow(x);
		for(var y=0; y<=same2; y++){
			var cell = row.insertCell(y);
			var random = Math.floor(Math.random() * 14);
			var src = "img/" + random + ".jpg"
			cell.innerHTML = "<img src='"+ src + "'>  </img>"
		}
	}
	audio = new Audio('audio/heart.mp3');
	song('heart', audio)
	delay(5.0)
}

function meme(){
	for (var x=0; x<10; x++){
		var random2 = Math.floor(Math.random() * 8);
		var src = "memes/" + random2 + ".png"
		console.log(src)
		makeDiv(src)
	}
}

function kmsMeme(image, scale){
	var divsize = Math.random() * 350 + 300;
	$newdiv = $('<div/>').css({
			'width': '100%',
			'height':'100%',
			'-webkit-background-size': 'cover',
			'-moz-background-size': 'cover',
			'-o-background-size': 'cover',
			'background-size': 'cover',
			'background-color': 'rgba(0,0,0,0.9)'
	});
	// col.innerHTML = "<img src='" + src + "'</img>"
	console.log(image)
	var src = "img/" + image + ".png"


	var posx = (0).toFixed();
	var posy = (0).toFixed();
	$newdiv.html("<img style='margin:auto; display:block; left:" + Math.random() * 100 +"px;width:" + divsize + "px; height:" + divsize*scale + "px' src='" + src + "'</img>");

	$newdiv.css({
			'position':'absolute',
			'left':posx+'px',
			'top':posy+'px'
	}).appendTo('body').hide().fadeIn(5000).delay(3000).fadeOut(5000, function(){
		$(this).remove();
		refreshIntervalId = window.setInterval(meme, 600);
	});
}

function kms(){
	clearInterval(refreshIntervalId);

	var random = Math.floor(Math.random() * 2)
	if(random == 0){
		kmsMeme("pony",1.4225)
	}
	else {
		kmsMeme("sonic", 1.4225)
	}
}

function repopulate(){
	var table = document.getElementById("cont");

	var random = Math.floor(Math.random() * table.rows.length)
	var random2 = Math.floor(Math.random() * table.rows[0].cells.length)
	var index = random*random2;
	var col = table.rows[random].cells[random2]

	var src = "img/" + Math.floor(Math.random() * 83) + ".jpg"
	col.innerHTML = "<img src='" + src + "'</img>"
	gridStatusArray[index] = 0;
}

function delay(time){
	repopulate();

	var seconds = time * 1000;
	setTimeout(function(){
		delay(time)
	}, seconds)
}

function fadeOut(el, callback) {
  var tick = function() {
    el.style.opacity = +el.style.opacity - 0.1;
		//
    if (+el.style.opacity > 0.0) {
      (window.requestAnimationFrame && requestAnimationFrame(tick)) || setTimeout(tick, 16)
    }

		if(el.style.opacity == 0.0){
			console.log("+el.style.opacity is ")
			console.log(+el.style.opacity)
			if(callback) callback(el);
		}
  };
  tick();

}


function changeBackground(){
	var color = getRandomColor();
	var overlay = document.getElementById("overlay")
	overlay.style.background = color
	document.body.style.background = getRandomColor()
}

function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++ ) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
}
function reshuffle(){
	repopulate();
}

function makeDiv(src){
    var divsize = ((Math.random()*300) + 50).toFixed();
    var color = '#'+ Math.round(0xffffff * Math.random()).toString(16);
    $newdiv = $('<div/>').css({
        'width':divsize+'px',
        'height':divsize+'px',
				'background-image': "url('" + src + "')",
				'-webkit-background-size': 'cover',
        '-moz-background-size': 'cover',
        '-o-background-size': 'cover',
        'background-size': 'cover'
    });

    var posx = (Math.random() * (screenWidth - divsize)).toFixed();
    var posy = (Math.random() * (screenHeight - divsize)).toFixed();

    $newdiv.css({
        'position':'absolute',
        'left':posx+'px',
        'top':posy+'px'
    }).appendTo( 'body' ).fadeIn(100).delay(400).fadeOut(500, function(){
      $(this).remove();
    });
};

function myFunction() {
    document.getElementById("myDropdown").classList.toggle("show");
}

function song(name){
	audio.src='audio/' + name + ".mp3";
	audio.play();
}


window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {

    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}

window.setInterval(repopulate, 100);
window.setInterval(kms, 20000);
var refreshIntervalId = window.setInterval(meme, 600);


</script>
</html>
